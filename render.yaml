# =============================================================================
# PGVectorRAGIndexer — Render Blueprint (Demo Instance)
# =============================================================================
#
# Deploys a read-only demo instance on Render free tier with auto-sleep.
# Uses Dockerfile.demo and connects to an EXTERNAL PostgreSQL with pgvector
# (e.g., Neon free tier — Render's free PG does not include pgvector).
#
# To deploy:
#   1. Create a Neon project at https://neon.tech (free, includes pgvector)
#   2. Push this file to your repo
#   3. Go to https://dashboard.render.com → New Web Service → connect repo
#   4. Set the env vars below from your Neon connection details
#
# The demo URL will be: https://demo-pgvectorrag.onrender.com
# =============================================================================

services:
  - type: web
    name: demo-pgvectorrag
    plan: free
    runtime: docker
    dockerfilePath: ./Dockerfile.demo
    dockerContext: .
    branch: feature/roadmap-v4
    healthCheckPath: /health
    envVars:
      - key: DEMO_MODE
        value: "1"
      - key: DB_HOST
        sync: false  # Set from Neon dashboard: ep-xxx.us-east-2.aws.neon.tech
      - key: DB_PORT
        value: "5432"
      - key: POSTGRES_USER
        sync: false  # Set from Neon dashboard
      - key: POSTGRES_PASSWORD
        sync: false  # Set from Neon dashboard (secret)
      - key: POSTGRES_DB
        value: "neondb"
      - key: DB_SSLMODE
        value: "require"
      - key: PYTHONUNBUFFERED
        value: "1"
      - key: API_HOST
        value: "0.0.0.0"
      - key: API_REQUIRE_AUTH
        value: "false"
